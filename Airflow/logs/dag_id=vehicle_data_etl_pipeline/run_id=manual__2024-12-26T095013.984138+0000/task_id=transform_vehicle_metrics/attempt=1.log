[2024-12-26T09:51:48.017+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-12-26T09:51:48.093+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: vehicle_data_etl_pipeline.transform_vehicle_metrics manual__2024-12-26T09:50:13.984138+00:00 [queued]>
[2024-12-26T09:51:48.132+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: vehicle_data_etl_pipeline.transform_vehicle_metrics manual__2024-12-26T09:50:13.984138+00:00 [queued]>
[2024-12-26T09:51:48.136+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 1
[2024-12-26T09:51:48.186+0000] {taskinstance.py:2889} INFO - Executing <Task(_PythonDecoratedOperator): transform_vehicle_metrics> on 2024-12-26 09:50:13.984138+00:00
[2024-12-26T09:51:48.196+0000] {standard_task_runner.py:72} INFO - Started process 10512 to run task
[2024-12-26T09:51:48.207+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'vehicle_data_etl_pipeline', 'transform_vehicle_metrics', 'manual__2024-12-26T09:50:13.984138+00:00', '--job-id', '42', '--raw', '--subdir', 'DAGS_FOLDER/batchVehiculeProcessing.py', '--cfg-path', '/tmp/tmpzj_abs91']
[2024-12-26T09:51:48.217+0000] {standard_task_runner.py:105} INFO - Job 42: Subtask transform_vehicle_metrics
[2024-12-26T09:51:48.415+0000] {task_command.py:467} INFO - Running <TaskInstance: vehicle_data_etl_pipeline.transform_vehicle_metrics manual__2024-12-26T09:50:13.984138+00:00 [running]> on host 3096e710f899
[2024-12-26T09:51:48.761+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='vehicle_data_etl_pipeline' AIRFLOW_CTX_TASK_ID='transform_vehicle_metrics' AIRFLOW_CTX_EXECUTION_DATE='2024-12-26T09:50:13.984138+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-12-26T09:50:13.984138+00:00'
[2024-12-26T09:51:48.782+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-12-26T09:52:21.000+0000] {logging_mixin.py:190} INFO - Spark session created !
[2024-12-26T09:53:41.298+0000] {job.py:229} INFO - Heartbeat recovered after 66.50 seconds
[2024-12-26T09:55:03.383+0000] {job.py:229} INFO - Heartbeat recovered after 75.91 seconds
[2024-12-26T09:55:26.654+0000] {logging_mixin.py:190} INFO - +----------+--------------------+----------+--------------------+-------------------+--------------------+------------+----------------------+--------------------+--------------------+---------------------+---------------+----------------------------+--------------------+-------------------------+--------------+--------------------+---------------+
|vehicle_id|               owner|speed_kmph|                road|          timestamp|        vehicle_size|vehicle_type|vehicle_classification|         coordinates|       engine_status|fuel_level_percentage|passenger_count|internal_temperature_celsius|   weather_condition|estimated_time_of_arrival|traffic_status|              alerts|processing_date|
+----------+--------------------+----------+--------------------+-------------------+--------------------+------------+----------------------+--------------------+--------------------+---------------------+---------------+----------------------------+--------------------+-------------------------+--------------+--------------------+---------------+
|   VH11294|{Nguyen Van A, 75...|  54.12531|{Duong Ton Duc Th...|2024-04-01 00:00:00|{1.9292884, 0.707...|   Motorbike|               Service|{10.761825, 106.6...|{true, 1011, Normal}|                   54|              0|                    26.08888|{27.699488, 62.18...|     {{Le Lai, Quan Go...| {Moderate, 8}|[{Speeding, Vehic...|     2024-12-26|
|   VH13624|{Nguyen Van T, 55...| 47.193314|{Nam Ky Khoi Nghi...|2024-04-01 00:00:00|{2.1411076, 0.887...|   Motorbike|               Service|{10.763961, 106.6...|{true, 1364, Normal}|                   23|              0|                    23.08911|{33.58538, 60.161...|     {{Nguyen Tat Than...|      {Low, 4}|[{Speeding, Fuel ...|     2024-12-26|
|   VH15411|{Nguyen Van R, 23...|  59.20741|{Duong Phan Xich ...|2024-04-01 00:00:00|{3.5777478, 1.472...|         Car|              Military|{10.782755, 106.6...|{true, 3897, Normal}|                   38|              4|                    20.93413|{27.900906, 58.37...|     {{Cau Sai Gon, Qu...|      {Low, 0}|[{Speeding, Vehic...|     2024-12-26|
|   VH15643|{Nguyen Van J, 10...| 51.280598|{Duong Hai Ba Tru...|2024-04-01 00:00:00|{2.1438801, 0.839...|   Motorbike|               Service|{10.774554, 106.6...|{true, 1874, Normal}|                   84|              0|                   20.993265|{27.081816, 79.46...|     {{Duong Truong Di...|     {High, 3}|[{Speeding, Fuel ...|     2024-12-26|
|   VH15733|{Nguyen Van W, 95...| 53.294014|{Pham Van Dong, Q...|2024-04-01 00:00:00|{2.0050921, 0.743...|   Motorbike|              Civilian|{10.7624855, 106....|{true, 3215, Normal}|                   90|              2|                   22.332287|{34.959023, 50.25...|     {{Duong Nguyen Th...|      {Low, 0}|[{Speeding, Vehic...|     2024-12-26|
|   VH17359|{Nguyen Van B, 57...| 50.908375|{Ly Thai To, Quan...|2024-04-01 00:00:00|{3.8520637, 1.55,...|         Car|              Civilian|{10.768852, 106.6...|{true, 2256, Normal}|                   17|              4|                   26.730392|{27.45591, 68.404...|     {{Phan Van Tri, Q...|      {Low, 3}|[{Speeding, Fuel ...|     2024-12-26|
|   VH19148|{Nguyen Van Q, 50...| 55.244152|{Kinh Duong Vuong...|2024-04-01 00:00:00|  {NULL, NULL, NULL}|       Truck|               Service|{10.798314, 106.6...|{true, 3855, Normal}|                   63|              0|                    21.59439|{32.869232, 54.61...|     {{Nguyen Thi Thap...|{Moderate, 14}|[{Speeding, Fuel ...|     2024-12-26|
|   VH20095|{Nguyen Van A, 59...|  52.24628|{Duong Le Thanh T...|2024-04-01 00:00:00|  {NULL, NULL, NULL}|       Truck|              Military|{10.773039, 106.6...|{true, 3859, Normal}|                   35|              4|                   29.882786|{29.107412, 68.02...|     {{Duong Dien Bien...|    {High, 20}|[{Speeding, Fuel ...|     2024-12-26|
|   VH22490|{Nguyen Van A, 24...| 54.965412|{Ton Duc Thang, Q...|2024-04-01 00:00:00|{1.9755003, 0.816...|   Motorbike|               Service|{10.762756, 106.6...|{true, 2997, Normal}|                   88|              5|                    25.15072|{26.691198, 77.41...|     {{Duong Hung Vuon...|     {Low, 15}|[{Low Fuel, Fuel ...|     2024-12-26|
|   VH22732|{Nguyen Van I, 45...|  48.29945|{Nguyen Tri Phuon...|2024-04-01 00:00:00|{1.7417979, 0.687...|     Bicycle|              Civilian|{10.784834, 106.6...|{true, 2121, Normal}|                   89|              4|                    20.45944|{30.602915, 71.17...|     {{An Duong Vuong,...|{Moderate, 20}|[{Low Fuel, Fuel ...|     2024-12-26|
|   VH23418|{Nguyen Van L, 91...| 58.968487|{Duong Cach Mang ...|2024-04-01 00:00:00|{2.1945267, 0.712...|   Motorbike|              Civilian|{10.767188, 106.6...|{true, 2504, Normal}|                   72|              5|                   28.358482|{32.264675, 59.98...|     {{Cau Sai Gon, Qu...|      {Low, 0}|[{Speeding, Fuel ...|     2024-12-26|
|   VH23804|{Nguyen Van H, 81...| 44.985157|{Duong Pasteur, Q...|2024-04-01 00:00:00|{1.9842228, 0.776...|   Motorbike|              Civilian|{10.780523, 106.6...|{true, 1713, Normal}|                   88|              3|                   23.998726|{28.946272, 55.76...|     {{Duong Nguyen Va...|      {Low, 8}|[{Speeding, Vehic...|     2024-12-26|
|   VH24230|{Nguyen Van H, 73...| 48.135567|{Thong Nhat, Quan...|2024-04-01 00:00:00|{1.8693249, 0.723...|   Motorbike|              Civilian|{10.754928, 106.6...|{true, 1216, Normal}|                   31|              4|                    26.29341|{27.099285, 79.55...|     {{Duong Le Van Sy...|     {Low, 19}|[{Low Fuel, Fuel ...|     2024-12-26|
|   VH26284|{Nguyen Van L, 61...| 45.067204|{Dai Lo Dong Tay,...|2024-04-01 00:00:00|{2.1873972, 0.725...|   Motorbike|               Service|{10.761486, 106.6...|{true, 1636, Normal}|                   31|              2|                   24.087166|{27.623796, 51.41...|     {{Phan Van Tri, Q...|      {Low, 1}|[{Speeding, Vehic...|     2024-12-26|
|   VH27219|{Nguyen Van B, 73...|   52.7221|{Ham Nghi, Quan 1...|2024-04-01 00:00:00|{1.8693162, 0.706...|   Motorbike|              Civilian|{10.793758, 106.6...|{true, 2440, Normal}|                   92|              3|                   28.922207|{27.522282, 71.41...|     {{Duong Pham Ngoc...|     {High, 0}|[{Low Fuel, Vehic...|     2024-12-26|
|   VH28099|{Nguyen Van K, 76...| 43.983124|{Duong Nguyen Tri...|2024-04-01 00:00:00|{4.3543267, 1.7, ...|         Car|              Civilian|{10.773919, 106.6...|{true, 2655, Normal}|                   46|              2|                   28.725979|{27.487091, 72.29...|     {{Le Lai, Quan 3,...| {Moderate, 1}|[{Speeding, Vehic...|     2024-12-26|
|   VH28634|{Nguyen Van M, 10...| 55.026722|{Thong Nhat, Quan...|2024-04-01 00:00:00|{2.1855624, 0.850...|   Motorbike|              Civilian|{10.791693, 106.6...|{true, 1707, Normal}|                   72|              0|                   28.675278|{26.875523, 52.25...|     {{Duong Nguyen Bi...|    {High, 10}|[{Low Fuel, Vehic...|     2024-12-26|
|   VH31425|{Nguyen Van J, 94...| 46.824978|{Duong Le Loi, Qu...|2024-04-01 00:00:00|{2.143807, 0.7629...|   Motorbike|               Service|{10.759956, 106.6...|{true, 1689, Normal}|                   15|              5|                   22.808533|{29.460457, 52.35...|     {{Tran Quoc Toan,...|     {Low, 13}|[{Low Fuel, Fuel ...|     2024-12-26|
|   VH33863|{Nguyen Van L, 66...| 45.412716|{Phan Van Tri, Qu...|2024-04-01 00:00:00|{2.1879945, 0.808...|   Motorbike|               Service|{10.781803, 106.6...|{true, 2095, Normal}|                   47|              0|                   21.420887|{29.032202, 73.66...|     {{Ly Thai To, Qua...| {Moderate, 0}|[{Speeding, Vehic...|     2024-12-26|
|   VH34147|{Nguyen Van F, 79...| 55.098804|{Duong Tran Hung ...|2024-04-01 00:00:00|{1.8106704, 0.788...|   Motorbike|               Service|{10.795321, 106.6...|{true, 1127, Normal}|                   18|              2|                   27.554598|{32.51783, 63.575...|     {{Duong Le Duan, ...|{Moderate, 20}|[{Low Fuel, Fuel ...|     2024-12-26|
+----------+--------------------+----------+--------------------+-------------------+--------------------+------------+----------------------+--------------------+--------------------+---------------------+---------------+----------------------------+--------------------+-------------------------+--------------+--------------------+---------------+
only showing top 20 rows
[2024-12-26T09:55:35.860+0000] {logging_mixin.py:190} INFO - +------------+---------+-----------------+-----------+
|vehicle_type|avg_speed|avg_trip_duration|total_trips|
+------------+---------+-----------------+-----------+
|     Bicycle|    52.81|           2480.0|          3|
|         Car|    48.92|           3405.0|         12|
|       Truck|    53.19|           3800.0|          9|
|         Bus|    40.22|           3960.0|          1|
|   Motorbike|    51.26|           3655.0|         75|
+------------+---------+-----------------+-----------+
[2024-12-26T09:55:39.772+0000] {python.py:240} INFO - Done. Returned value was: /tmp/vehicle_metrics
[2024-12-26T09:55:39.879+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2024-12-26T09:55:39.883+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=vehicle_data_etl_pipeline, task_id=transform_vehicle_metrics, run_id=manual__2024-12-26T09:50:13.984138+00:00, execution_date=20241226T095013, start_date=20241226T095148, end_date=20241226T095539
[2024-12-26T09:55:40.008+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2024-12-26T09:55:40.077+0000] {taskinstance.py:3895} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-12-26T09:55:40.092+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
